# ì–‘ì‚°ì™¸êµ­ì¸ë…¸ë™ìì˜ì§‘ í™ˆí˜ì´ì§€

Flask ê¸°ë°˜ SSG(Static Site Generation) í•˜ì´ë¸Œë¦¬ë“œ ì‹œìŠ¤í…œìœ¼ë¡œ êµ¬ì¶•ëœ ë¹„ì˜ë¦¬ë‹¨ì²´ í™ˆí˜ì´ì§€ì…ë‹ˆë‹¤.

## í”„ë¡œì íŠ¸ ê°œìš”

ì •ì  ì‚¬ì´íŠ¸ì˜ ë¹ ë¥¸ ì†ë„ì™€ ë™ì  ê´€ë¦¬ì˜ í¸ì˜ì„±ì„ ê²°í•©í•œ í•˜ì´ë¸Œë¦¬ë“œ ì‹œìŠ¤í…œì…ë‹ˆë‹¤.
- **ì‚¬ìš©ì**: ë¹Œë“œëœ ì •ì  HTML ì œê³µ (ë¹ ë¥¸ ì†ë„)
- **ê´€ë¦¬ì**: Flask ê¸°ë°˜ CMSë¡œ ì½˜í…ì¸  ê´€ë¦¬
- **ìë™í™”**: DB ë³€ê²½ ì‹œ ìë™ìœ¼ë¡œ ì •ì  ì‚¬ì´íŠ¸ ì¬ìƒì„±

---

## ê¸°ìˆ  ìŠ¤íƒ

### ë°±ì—”ë“œ
- **Flask 3.0** - ì›¹ í”„ë ˆì„ì›Œí¬
- **SQLAlchemy** - ORM
- **SQLite** - ë°ì´í„°ë² ì´ìŠ¤
- **Gunicorn** - WSGI ì„œë²„

### í”„ë¡ íŠ¸ì—”ë“œ
- **Jinja2** - í…œí”Œë¦¿ ì—”ì§„
- **Tailwind CSS** - CSS í”„ë ˆì„ì›Œí¬
- **Alpine.js** - ê°„ë‹¨í•œ ì¸í„°ë™ì…˜
- **Toast UI Editor** - WYSIWYG ì—ë””í„°
- **SortableJS** - ë“œë˜ê·¸ì•¤ë“œë¡­ ì •ë ¬

### ë¹Œë“œ ì‹œìŠ¤í…œ
- **SSG ë¹Œë“œ**: Python ê¸°ë°˜ ì •ì  ì‚¬ì´íŠ¸ ìƒì„±
- **ìë™ íŠ¸ë¦¬ê±°**: DB ë³€ê²½ ê°ì§€ â†’ ìë™ ë¹Œë“œ
- **ë¹Œë“œ ëª¨ë‹ˆí„°ë§**: ì‹¤ì‹œê°„ ìƒíƒœ í™•ì¸

---

## ì£¼ìš” ê¸°ëŠ¥

### ì‚¬ìš©ì í˜ì´ì§€ (ì •ì )
- ğŸ  ë©”ì¸ í˜ì´ì§€
- ğŸ“¢ ê³µì§€ì‚¬í•­ ëª©ë¡/ìƒì„¸
- ğŸ“¸ í™œë™í›„ê¸° ëª©ë¡/ìƒì„¸ (ì¹´í…Œê³ ë¦¬ë³„)
- ğŸ“° ì†Œì‹ì§€ ëª©ë¡/ìƒì„¸
- â„¹ï¸ ì†Œê°œ í˜ì´ì§€ (ì—°í˜, ì‚¬ì—…ë¶„ì•¼, ì˜¤ì‹œëŠ” ê¸¸)
- ğŸ’ í•¨ê»˜í•˜ê¸° (í›„ì› ì‹ ì²­)

### ê´€ë¦¬ì í˜ì´ì§€ (ë™ì )
- ğŸ” ë¡œê·¸ì¸ / ê³„ì • ê´€ë¦¬
- ğŸ“Š ëŒ€ì‹œë³´ë“œ (ë¹Œë“œ ìƒíƒœ, í†µê³„)
- ğŸ“ ì½˜í…ì¸  ê´€ë¦¬ (ê³µì§€ì‚¬í•­, í™œë™í›„ê¸°, ì†Œì‹ì§€)
- âš™ï¸ ì‚¬ì´íŠ¸ ì„¤ì • (ì‚¬ì´íŠ¸ ì •ë³´, ì‚¬ì—…ë¶„ì•¼, í›„ì› ì•ˆë‚´)
- ğŸ“œ ì—°í˜ ê´€ë¦¬
- ğŸšŒ ì˜¤ì‹œëŠ” ê¸¸ (ëŒ€ì¤‘êµí†µ, ìš´ì˜ì‹œê°„)
- ğŸ’° í›„ì› ì‹ ì²­ ë‚´ì—­ í™•ì¸ ë° PDF ìƒì„±
- ğŸ—ï¸ ë¹Œë“œ íˆìŠ¤í† ë¦¬

### ìë™í™” ê¸°ëŠ¥
- âœ… DB ë³€ê²½ ê°ì§€ â†’ ìë™ ë¹Œë“œ íŠ¸ë¦¬ê±°
- âœ… ë°±ê·¸ë¼ìš´ë“œ ë¹Œë“œ (ê´€ë¦¬ì ì‘ì—… ë°©í•´ ì•ˆí•¨)
- âœ… ë¹Œë“œ ìƒíƒœ ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§
- âœ… ë¹Œë“œ íˆìŠ¤í† ë¦¬ ê¸°ë¡ ë° ì¡°íšŒ

---

## í”„ë¡œì íŠ¸ êµ¬ì¡°

```
homepage/
â”œâ”€â”€ app.py                    # Flask ë©”ì¸ ì•±
â”œâ”€â”€ models.py                 # ë°ì´í„°ë² ì´ìŠ¤ ëª¨ë¸ (21ê°œ)
â”œâ”€â”€ config.py                 # ì„¤ì • íŒŒì¼
â”œâ”€â”€ build.py                  # SSG ë¹Œë“œ ì—”ì§„
â”œâ”€â”€ build_triggers.py         # ìë™ ë¹Œë“œ íŠ¸ë¦¬ê±° ì‹œìŠ¤í…œ
â”œâ”€â”€ background_builder.py     # ë°±ê·¸ë¼ìš´ë“œ ë¹Œë“œ ì‹¤í–‰
â”œâ”€â”€ run_build.py              # ë…ë¦½ í”„ë¡œì„¸ìŠ¤ ë¹Œë“œ
â”œâ”€â”€ ssg_serve.py              # ì •ì  íŒŒì¼ ê°œë°œ ì„œë²„
â”œâ”€â”€ requirements.txt          # Python íŒ¨í‚¤ì§€ ëª©ë¡
â”œâ”€â”€ data.db                   # SQLite ë°ì´í„°ë² ì´ìŠ¤
â”‚
â”œâ”€â”€ admin/                    # ê´€ë¦¬ì ëª¨ë“ˆ
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ routes.py             # ê´€ë¦¬ì ë¼ìš°íŠ¸ (60+ ì—”ë“œí¬ì¸íŠ¸)
â”‚   â”œâ”€â”€ auth.py               # ì¸ì¦ ë°ì½”ë ˆì´í„°
â”‚   â””â”€â”€ utils.py              # íŒŒì¼ ì—…ë¡œë“œ ìœ í‹¸ë¦¬í‹°
â”‚
â”œâ”€â”€ templates/                # Jinja2 í…œí”Œë¦¿
â”‚   â”œâ”€â”€ ssg/                  # ì •ì  ì‚¬ì´íŠ¸ í…œí”Œë¦¿
â”‚   â”‚   â”œâ”€â”€ base.html
â”‚   â”‚   â”œâ”€â”€ index.html
â”‚   â”‚   â”œâ”€â”€ intro.html
â”‚   â”‚   â”œâ”€â”€ notice.html
â”‚   â”‚   â”œâ”€â”€ activity.html
â”‚   â”‚   â”œâ”€â”€ newsletter.html
â”‚   â”‚   â””â”€â”€ donation.html
â”‚   â””â”€â”€ admin/                # ê´€ë¦¬ì í˜ì´ì§€ í…œí”Œë¦¿
â”‚       â”œâ”€â”€ base.html
â”‚       â”œâ”€â”€ login.html
â”‚       â”œâ”€â”€ dashboard.html
â”‚       â””â”€â”€ [ê¸°ëŠ¥ë³„ í…œí”Œë¦¿]
â”‚
â”œâ”€â”€ static/                   # ì •ì  íŒŒì¼
â”‚   â”œâ”€â”€ css/
â”‚   â”‚   â”œâ”€â”€ design-system.css
â”‚   â”‚   â””â”€â”€ styles.css
â”‚   â”œâ”€â”€ js/
â”‚   â”‚   â””â”€â”€ main.js
â”‚   â””â”€â”€ images/
â”‚       â”œâ”€â”€ logo.svg
â”‚       â””â”€â”€ logo-text.svg
â”‚
â”œâ”€â”€ dist/                     # ë¹Œë“œ ê²°ê³¼ë¬¼ (ì •ì  ì‚¬ì´íŠ¸)
â”‚   â”œâ”€â”€ index.html
â”‚   â”œâ”€â”€ intro.html
â”‚   â”œâ”€â”€ notice/
â”‚   â”œâ”€â”€ activity/
â”‚   â”œâ”€â”€ newsletter/
â”‚   â”œâ”€â”€ donation.html
â”‚   â”œâ”€â”€ static/
â”‚   â””â”€â”€ uploads/              # ì—…ë¡œë“œ íŒŒì¼
â”‚
â””â”€â”€ logs/                     # ë¡œê·¸ íŒŒì¼
    â”œâ”€â”€ app.log               # ì•± ë¡œê·¸
    â””â”€â”€ build.log             # ë¹Œë“œ ë¡œê·¸
```

---

## ë¹ ë¥¸ ì‹œì‘

### 1. í™˜ê²½ ì„¤ì •

```bash
# Python 3.9+ í•„ìš”
python3 --version

# ê°€ìƒí™˜ê²½ ìƒì„± ë° í™œì„±í™”
python3 -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate

# íŒ¨í‚¤ì§€ ì„¤ì¹˜
pip install -r requirements.txt
```

### 2. í™˜ê²½ë³€ìˆ˜ ì„¤ì •

`.env` íŒŒì¼ ìƒì„±:

```bash
# ê°œë°œ í™˜ê²½
STATIC_DOMAIN=http://localhost:3000
API_DOMAIN=http://localhost:8000
STATIC_SITE_URL=http://localhost:3000

SECRET_KEY=your-secret-key-change-this
DONATION_EMAIL=happysoli@hanmail.net
```

### 3. ë°ì´í„°ë² ì´ìŠ¤ ì´ˆê¸°í™”

```bash
# Flask shellì—ì„œ DB ìƒì„±
python3
>>> from app import app, db
>>> with app.app_context():
...     db.create_all()
>>> exit()
```

### 4. ê´€ë¦¬ì ê³„ì • ìƒì„±

```bash
python3
>>> from app import app, db
>>> from models import AdminUser
>>> with app.app_context():
...     admin = AdminUser(
...         username='admin',
...         email='admin@example.com',
...         is_super_admin=True
...     )
...     admin.set_password('your-password')
...     db.session.add(admin)
...     db.session.commit()
>>> exit()
```

### 5. Flask ì•± ì‹¤í–‰

```bash
python3 app.py
# http://localhost:8000 ì—ì„œ ì ‘ì†
# ê´€ë¦¬ì ë¡œê·¸ì¸: http://localhost:8000/login
```

### 6. SSG ë¹Œë“œ ë° ì„œë¹™

```bash
# ì •ì  ì‚¬ì´íŠ¸ ë¹Œë“œ
python3 build.py

# ê°œë°œ ì„œë²„ë¡œ ì •ì  ì‚¬ì´íŠ¸ í™•ì¸
python3 ssg_serve.py
# http://localhost:3000 ì—ì„œ ì ‘ì†
```

---

## ê°œë°œ ê°€ì´ë“œ

### ë””ìì¸ ì›ì¹™

- **ë…¸ì…˜ ìŠ¤íƒ€ì¼**: ê¹”ë”í•œ ì¹´ë“œ UI
- **ì‹¬í”Œí•¨**: ê³¼í•œ ì¥ì‹ ì§€ì–‘
- **ë°˜ì‘í˜•**: ëª¨ë°”ì¼ ìš°ì„ 
- **í•œê¸€**: UIì™€ ì£¼ì„ ëª¨ë‘ í•œê¸€

### ìƒ‰ìƒ íŒ”ë ˆíŠ¸

```css
--primary: #3B82F6      /* íŒŒë€ìƒ‰ */
--dark-800: #1e293b     /* ì§„í•œ íšŒìƒ‰ */
--dark-600: #475569     /* ì¤‘ê°„ íšŒìƒ‰ */
```

### ëª¨ë¸ ì¶”ê°€í•˜ê¸°

```python
# models.py
class NewModel(db.Model, DisplayOrderMixin):
    """ìƒˆ ëª¨ë¸ ì„¤ëª…"""
    __tablename__ = 'new_model'

    id = db.Column(db.Integer, primary_key=True)
    name = db.Column(db.String(200), nullable=False)
    created_at = db.Column(db.DateTime, default=datetime.utcnow)

    def to_dict(self):
        return {
            'id': self.id,
            'name': self.name,
            'created_at': self.created_at.isoformat() if self.created_at else None
        }
```

### ê´€ë¦¬ì CRUD ë¼ìš°íŠ¸ íŒ¨í„´

```python
# admin/routes.py
@admin_bp.route('/items')
@login_required
def list_items():
    """ëª©ë¡"""
    items = NewModel.query.all()
    return render_template('admin/items/list.html', items=items)

@admin_bp.route('/items/add', methods=['GET', 'POST'])
@login_required
def add_item():
    """ì¶”ê°€"""
    if request.method == 'POST':
        item = NewModel(name=request.form['name'])
        db.session.add(item)
        db.session.commit()
        return redirect(url_for('admin.list_items'))
    return render_template('admin/items/form.html')

@admin_bp.route('/items/edit/<int:id>', methods=['GET', 'POST'])
@login_required
def edit_item(id):
    """ìˆ˜ì •"""
    item = NewModel.query.get_or_404(id)
    if request.method == 'POST':
        item.name = request.form['name']
        db.session.commit()
        return redirect(url_for('admin.list_items'))
    return render_template('admin/items/form.html', item=item)

@admin_bp.route('/items/delete/<int:id>', methods=['POST'])
@login_required
def delete_item(id):
    """ì‚­ì œ"""
    item = NewModel.query.get_or_404(id)
    db.session.delete(item)
    db.session.commit()
    return redirect(url_for('admin.list_items'))
```

### ìë™ ë¹Œë“œ íŠ¸ë¦¬ê±° ì¶”ê°€

```python
# build_triggers.py
# ìë™ ë¹Œë“œê°€ í•„ìš”í•œ ëª¨ë¸ì— ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€

@event.listens_for(NewModel, 'after_insert')
@event.listens_for(NewModel, 'after_update')
@event.listens_for(NewModel, 'after_delete')
def trigger_build_on_new_model_change(mapper, connection, target):
    """NewModel ë³€ê²½ ì‹œ ë¹Œë“œ íŠ¸ë¦¬ê±°"""
    trigger_build(triggered_by=f'NewModel #{target.id}')
```

---

## ìë™ ë¹Œë“œ ì‹œìŠ¤í…œ

### ì‘ë™ ì›ë¦¬

```
DB ë³€ê²½ ë°œìƒ
    â†“
build_triggers.py (ì´ë²¤íŠ¸ ê°ì§€)
    â†“
background_builder.py (ë¹„ë™ê¸° ì‹¤í–‰)
    â†“
run_build.py (ë…ë¦½ í”„ë¡œì„¸ìŠ¤)
    â†“
build.py (ì‹¤ì œ ë¹Œë“œ)
    â†“
dist/ í´ë”ì— ì •ì  ì‚¬ì´íŠ¸ ìƒì„±
```

### ìë™ ë¹Œë“œ ëŒ€ìƒ ëª¨ë¸

- **ì½˜í…ì¸ **: Notice, ActivityPost, Newsletter, ActivityCategory
- **ì‚¬ì´íŠ¸ ì •ë³´**: SiteInfo, BusinessArea, SponsorshipInfo
- **í›„ì›**: VolunteerArea, DonationArea, DonationUsage
- **ì—°í˜**: HistorySection, HistoryItem
- **í™œë™**: ActivityPhoto
- **êµí†µ**: BusStop, BusRoute, OperatingHours, OfficeInfo

### ë¹Œë“œ ìƒíƒœ í™•ì¸

- **ëŒ€ì‹œë³´ë“œ**: `/dashboard` - ì‹¤ì‹œê°„ ë¹Œë“œ ìƒíƒœ
- **ë¹Œë“œ íˆìŠ¤í† ë¦¬**: `/build/history` - ì „ì²´ ë¹Œë“œ ë‚´ì—­
- **API**: `/build/status` - JSON í˜•ì‹ ìƒíƒœ

### ìˆ˜ë™ ë¹Œë“œ

```bash
# ì»¤ë§¨ë“œë¼ì¸
python3 build.py

# ë˜ëŠ” ê´€ë¦¬ì í˜ì´ì§€ì—ì„œ
# "ë¹Œë“œ íˆìŠ¤í† ë¦¬" í˜ì´ì§€ â†’ "ìˆ˜ë™ ë¹Œë“œ" ë²„íŠ¼
```

---

## ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰

### ë‹¨ì¼ ì•± ê¸°ì¤€

- **ë©”ëª¨ë¦¬**: 50-75 MB per worker
- **ë””ìŠ¤í¬**: ~145 MB (ì—…ë¡œë“œ íŒŒì¼ í¬í•¨)
- **CPU**: < 5% (í‰ì†Œ), 30-50% (ë¹Œë“œ ì‹œ)

### 3ê°œ ì•± ë™ì‹œ ìš´ì˜ ì‹œ (Vultr $12/ì›” ê¸°ì¤€)

```yaml
ì„œë²„ ì‚¬ì–‘:
  CPU: 2 vCPU
  RAM: 2 GB
  Disk: 55 GB SSD
  íŠ¸ë˜í”½: 2 TB/ì›”

Gunicorn ì›Œì»¤:
  ì•±ë‹¹ ì›Œì»¤: 3ê°œ
  ì´ ì›Œì»¤: 9ê°œ
  ë©”ëª¨ë¦¬ ì‚¬ìš©: ~675 MB

ì˜ˆìƒ ì„±ëŠ¥:
  ë™ì‹œ ì ‘ì†: 50-100ëª…
  ì‘ë‹µ ì‹œê°„: < 300ms
  ì›”ê°„ ë°©ë¬¸ì: ì•±ë‹¹ 5,000ëª…
```
---

## ë°°í¬

ìƒì„¸í•œ ë°°í¬ ê°€ì´ë“œëŠ” [DEPLOYMENT_GUIDE.md](DEPLOYMENT_GUIDE.md)ë¥¼ ì°¸ì¡°í•˜ì„¸ìš”.

---

## ë¡œê·¸ í™•ì¸

```bash
# ì•± ë¡œê·¸ (ì‹¤ì‹œê°„)
tail -f logs/app.log

# ë¹Œë“œ ë¡œê·¸ (ì‹¤ì‹œê°„)
tail -f logs/build.log

# ìµœê·¼ 50ì¤„
tail -50 logs/app.log
```

---

## íŠ¸ëŸ¬ë¸”ìŠˆíŒ…

### ë¹Œë“œê°€ ì‹œì‘ë˜ì§€ ì•ŠìŒ

```bash
# ë¡œê·¸ í™•ì¸
tail -f logs/app.log

# ë¹Œë“œ í”„ë¡œì„¸ìŠ¤ í™•ì¸
ps aux | grep run_build.py
```

### ì´ë¯¸ì§€ê°€ í‘œì‹œë˜ì§€ ì•ŠìŒ

- `dist/uploads/` í´ë” í™•ì¸
- íŒŒì¼ ê¶Œí•œ í™•ì¸ (755)
- Nginx ì„¤ì • í™•ì¸ (`/uploads/` ê²½ë¡œ)

### í›„ì› ì‹ ì²­ì´ ì œì¶œë˜ì§€ ì•ŠìŒ

- ë¸Œë¼ìš°ì € ì½˜ì†” í™•ì¸ (F12 â†’ Network)
- API_DOMAIN í™˜ê²½ë³€ìˆ˜ í™•ì¸
- CORS ì„¤ì • í™•ì¸ (app.py)

---

## ë¼ì´ì„ ìŠ¤

ì´ í”„ë¡œì íŠ¸ëŠ” ë¹„ì˜ë¦¬ë‹¨ì²´ í™ˆí˜ì´ì§€ CMSë¡œ ê°œë°œë˜ì—ˆìŠµë‹ˆë‹¤.

---

## ë¬¸ì˜

- ì´ë©”ì¼: happysoli@hanmail.net
- ì£¼ì†Œ: ê²½ìƒë‚¨ë„ ì–‘ì‚°ì‹œ ë¶ì•ˆë¶7ê¸¸35 ì–‘ì‚°ì‹œê·¼ë¡œìì¢…í•©ë³µì§€ê´€ 1ì¸µ
- ì „í™”: 055-388-0988
